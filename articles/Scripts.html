<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
    
    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Scripts | Chaos Server Docs </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Scripts | Chaos Server Docs ">
      <meta name="generator" content="docfx 2.59.4.0">
      
      <link rel="shortcut icon" href="../images/chaos.ico">
      <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/night-owl.min.css">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" integrity="sha384-EvBWSlnoFgZlXJvpzS+MAUEjvN7+gcCwH+qh7GRFOGgZO0PuwOFro7qPOJnLfe7l" crossorigin="anonymous">
      <link rel="stylesheet" href="../styles/config.css">
      <link rel="stylesheet" href="../styles/discord.css">
      <link rel="stylesheet" href="../styles/singulink.css">
      <link rel="stylesheet" href="../styles/main.css">
      <meta property="docfx:navrel" content="../toc.html">
      <meta property="docfx:tocrel" content="toc.html">
      
      <meta property="docfx:rel" content="../">
      <meta property="docfx:newtab" content="true">
    </head>
    <body>
        <div class="top-navbar">
            <a class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="34" height="34" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>

            
            <a class="brand" href="../index.html">
              <img src="../images/chaosico.png" alt="Chaos Server Docs" class="logomark">
              <span class="brand-title">Chaos Server Docs</span>
            </a>        </div>

        <div class="body-content">
            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">
                <div class="sidebar">
                    
                    <div>
                      <div class="mobile-hide">
                        
                        <a class="brand" href="../index.html">
                          <img src="../images/chaosico.png" alt="Chaos Server Docs" class="logomark">
                          <span class="brand-title">Chaos Server Docs</span>
                        </a>  </div>
                    
                      <div class="sidesearch">
                        <form id="search" role="search" class="search">
                            <i class="bi bi-search search-icon"></i>
                            <input type="text" id="search-query" placeholder="Search" autocomplete="off">
                        </form>
                      </div>
                    
                      <div id="navbar">
                      </div>
                    </div>                    <div class="sidebar-item-separator"></div>
                        
                        <div id="sidetoggle">
                          <div id="sidetoc"></div>
                        </div>
                </div>
                <div class="footer">
                  
                  <strong><a href='https://dotnet.github.io/docfx/'>DocFX</a> + <a href='https://www.singulink.com'>Singulink</a> = ♥</strong>
                </div>            </nav>

            <main class="main-panel">
                
                <div id="search-results" style="display: none;">
                  <h1 class="search-list">Search Results for <span></span></h1>
                  <div class="sr-items">
                    <p><i class="bi bi-hourglass-split index-loading"></i></p>
                  </div>
                  <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
                </div>
                <div role="main" class="hide-when-search">
                        
                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                    <article class="content wrap" id="_content" data-uid="">
<h1 id="scripts">Scripts</h1>

<p>The server runs on scripts. Skills, Spells, Items, Dialogs, Monsters, Merchants, MapInstances, ReactorTiles, etc.. are all scripted objects.
To control
how these objects respond to input, a script must be written. Scripts can be found under <code>Chaos.Scripts</code>. There are a number of
default scripts created as examples, but writing your own scripts is the only way to truly customize the server.</p>
<p>There are 2 main types of scripts for most entities. <code>Base Scripts</code> and <code>Configurable Scripts</code>. Let's take item scripts as an example. There
are 2 base types you can choose to use, the <a class="xref" href="../api/Chaos.Scripts.ItemScripts.Abstractions.ItemScriptBase.html">ItemScriptBase</a> and
the <a class="xref" href="../api/Chaos.Scripts.ItemScripts.Abstractions.ConfigurableItemScriptBase.html">ConfigurableItemScriptBase</a>.</p>
<h3 id="base-scripts">Base Scripts</h3>
<p>Base scripts are just empty scripts with no functionality. They have empty virtual implementations of all of the possible events that could
occur for that object. These events are intended to be overridden and have functionality added.</p>
<div class="TIP">
<h5>Tip</h5>
<p>Base scripts are intended for use when no external configuration is necessary. The script should generally do something specific</p>
</div>
<h3 id="configurable-scripts">Configurable Scripts</h3>
<p>Configurable scripts are also empty scripts with all empty virtual implementations. The difference here is that these scripts are intended
to have variables passed into them from json. Configurable scripts have an underlying mechanism that populates protected read/writeable
variables
automatically if it can find that variable within the source json the entity was created from. Configurable scripts read from
the <code>scriptVars</code> property from whatever entity is the subject of that script.</p>
<p>For example, here is a script that is used for consumable items that give back health or mana.</p>
<pre><code class="lang-csharp" highlight-lines="33-38">using Chaos.Common.Definitions;
using Chaos.Objects.Panel;
using Chaos.Objects.World;
using Chaos.Scripts.ItemScripts.Abstractions;

namespace Chaos.Scripts.ItemScripts;

public class VitalityConsumableScript : ConfigurableItemScriptBase
{
    /// &lt;inheritdoc /&gt;
    public VitalityConsumableScript(Item subject)
        : base(subject) { }

    /// &lt;inheritdoc /&gt;
    public override void OnUse(Aisling source)
    {
        if (HealthAmount.HasValue)
            source.UserStatSheet.AddHp(HealthAmount.Value);

        if (HealthPercent.HasValue)
            source.UserStatSheet.AddHealthPct(HealthPercent.Value);

        if (ManaAmount.HasValue)
            source.UserStatSheet.AddMp(ManaAmount.Value);

        if (ManaPercent.HasValue)
            source.UserStatSheet.AddManaPct(ManaPercent.Value);

        source.Client.SendAttributes(StatUpdateType.Vitality);
        source.Inventory.RemoveQuantity(Subject.Slot, 1);
    }

    #region ScriptVars
    protected int? HealthAmount { get; init; }
    protected int? HealthPercent { get; init; }
    protected int? ManaAmount { get; init; }
    protected int? ManaPercent { get; init; }
    #endregion
}
</code></pre>
<p>Note the <code>scriptVars</code> region. These properties don't appear to be set anywhere, but they are automatically populated by the script's base
implementation from the item's json.</p>
<p>Here is a json for an <code>apple</code> item, note the <code>scriptVars</code> property</p>
<pre><code class="lang-json" highlight-lines="11-15">{
    &quot;templateKey&quot;: &quot;apple&quot;,
    &quot;accountBound&quot;: false,
    &quot;maxStacks&quot;: 100,
    &quot;buyCost&quot;: 100,
    &quot;sellValue&quot;: 50,
    &quot;weight&quot;: 1,
    &quot;name&quot;: &quot;Apple&quot;,
    &quot;panelSprite&quot;: 40,
    &quot;scriptKeys&quot;: [&quot;vitalityConsumable&quot;],
    &quot;scriptVars&quot;: {
        &quot;vitalityConsumable&quot;: {
            &quot;healthAmount&quot;: 100
        }
    }
}
</code></pre>
<p>Here the <code>scriptKeys</code> collection contains the <code>vitalityConsumable</code> script key, signaling that the <code>VitalityConsumableScript</code> should be
attached to this entity.
The <code>scriptVars</code> object here provides configuration for that script. If multiple configurable scripts are used, multiple configurations can
be specified.</p>
<div class="NOTE">
<h5>Note</h5>
<p>The key of a script is the name of the class without &quot;Script&quot; at the end. So <code>VitalityConsumableScript</code> would have the
key <code>VitalityConsumable</code></p>
</div>
<pre><code class="lang-json">&quot;scriptKeys&quot;: {
  &quot;vitalityConsumable&quot;: {
    ...
  },
  &quot;someQuest&quot;: {
    ...
  }
}
</code></pre>
</article>
                </div>

            </main>
        </div>

        
        <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
        <script type="text/javascript" src="../styles/jquery.twbsPagination.js"></script>
        <script type="text/javascript" src="../styles/url.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
        <script type="text/javascript" src="../styles/docfx.js"></script>
        <script type="text/javascript" src="../styles/singulink.js"></script>
        <script type="text/javascript" src="../styles/main.js"></script>    </body>
</html>
